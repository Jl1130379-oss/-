<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>æ±Ÿå®¶æ™ºæ…§åŸå¸‚ | çœŸÂ·å­¸è¡“æ¼”é€²ç³»çµ±</title>
    <style>
        :root { --blue: #00f2fe; --pink: #ff00de; --gold: #ffd700; --bg: #010206; }
        body { margin: 0; background: var(--bg); color: #fff; font-family: 'PingFang TC', sans-serif; overflow: hidden; }
        .viewport { width: 100vw; height: 100vh; display: flex; flex-direction: column; }
        
        /* æ•¸æ“šæ¬„ä½ */
        .hud { display: flex; justify-content: space-between; padding: 20px 45px; background: rgba(0, 242, 254, 0.05); border-bottom: 2px solid var(--blue); }
        .stat { font-size: 1.2rem; font-weight: bold; text-shadow: 0 0 10px var(--blue); }

        /* å°å¸«èˆå° */
        .stage { display: flex; justify-content: center; align-items: center; gap: 80px; flex: 1; }
        .pod { text-align: center; cursor: pointer; transition: 0.5s ease; width: 220px; }
        .avatar { 
            width: 200px; height: 200px; border-radius: 50%; border: 4px solid var(--blue);
            background-size: cover; background-position: center; box-shadow: 0 0 30px rgba(0, 242, 254, 0.3);
            margin: 0 auto;
        }
        .locked { filter: grayscale(1) brightness(0.15); opacity: 0.3; pointer-events: none; transform: scale(0.9); }

        /* äº¤äº’é¢æ¿ */
        .panel {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 900px; background: rgba(5, 12, 30, 0.98);
            border: 2px solid var(--gold); border-radius: 40px; padding: 35px;
            display: none; z-index: 2000; box-shadow: 0 0 50px #000;
        }
        .btn { padding: 12px 30px; border-radius: 50px; border: 1px solid var(--blue); background: transparent; color: #fff; cursor: pointer; font-weight: bold; margin: 10px; transition: 0.3s; }
        .btn:hover { background: var(--blue); color: #000; }
        .opt-btn { width: 100%; text-align: left; margin: 8px 0; background: rgba(255,255,255,0.05); }
    </style>
</head>
<body>

<div class="viewport">
    <div class="hud">
        <div class="stat" style="color:var(--gold)">ğŸ® æ˜ç‡ˆ: <span id="coin-ui">0</span></div>
        <div id="status-tag">ğŸ›ï¸ æ±Ÿå®¶æ™ºæ…§åŸå¸‚ - è«‹é»æ“Šè‡ªå‹•åŠ èª²</div>
        <div class="stat" style="color:var(--pink)">â¤ï¸ HP: <span id="hp-ui">100</span></div>
    </div>

    <div class="stage">
        <div class="pod" id="pod-ling" onclick="selectTeacher('ling')">
            <div class="avatar" style="background-image: url('https://i.postimg.cc/mrhp4G1r/ling.png');"></div>
            <h3 style="color:var(--blue)">æ±Ÿéˆ´ (ç†ç§‘)</h3>
            <div style="font-size:0.8rem; color:var(--gold)">ğŸ‘— æµå‹•æ¥µå…‰è£™</div>
        </div>
        <div class="pod" id="pod-yi" onclick="selectTeacher('yi')">
            <div class="avatar" style="background-image: url('https://i.postimg.cc/pT3Y0yB0/yi.png'); border-color:var(--pink)"></div>
            <h3 style="color:var(--pink)">æ±Ÿä¾ (æ–‡ç§‘)</h3>
            <div style="font-size:0.8rem; color:var(--gold)">ğŸ‘˜ è½æ«»ç¹½ç´›æ¼¢æœ</div>
        </div>
    </div>

    <div class="panel" id="main-panel">
        <div id="timer-ui" style="float:right; font-size:2rem; color:var(--pink); font-family:monospace;"></div>
        <h2 id="panel-title" style="color:var(--gold)"></h2>
        <div id="panel-content" style="line-height:1.8; margin-bottom: 20px; font-size: 1.1rem;"></div>
        <div id="difficulty-selector" style="display:none; grid-template-columns: repeat(3, 1fr); gap:10px;">
            <button class="btn" onclick="setDiff('åœ‹å°')">åœ‹å°</button>
            <button class="btn" onclick="setDiff('åœ‹ä¸­')">åœ‹ä¸­</button>
            <button class="btn" onclick="setDiff('é«˜ä¸­')">é«˜ä¸­</button>
            <button class="btn" onclick="setDiff('å¤§å­¸')">å¤§å­¸</button>
            <button class="btn" onclick="setDiff('ç¢©åš')">ç¢©åš</button>
        </div>
        <div id="options-area"></div>
        <div id="control-area" style="text-align:center;"></div>
    </div>

    <div style="text-align:center; padding-bottom: 40px;">
        <button id="add-btn" class="btn" style="border-color:var(--gold); color:var(--gold)" onclick="triggerLoad()">âš¡ è‡ªå‹•åŠ èª² (çœŸæ­£çš„é¡Œç›®)</button>
        <button class="btn" onclick="exchange()">æ¼”åŒ–æ–°å‹•ä½œ (æ­¸é›¶)</button>
    </div>
</div>

<script>
    let state = { coin: 0, hp: 100, mode: 'idle', level: '', teacher: '', currentQ: null, timer: null };

    // ã€çœŸå¯¦é¡Œåº«å¼•æ“ã€‘æ ¹æ“šé›£åº¦ç”Ÿæˆé¡Œç›®
    const RealQuestionBank = {
        fetch() {
            const pool = [
                { topic: "å…‰å­¸èˆ‡èƒ½é‡", levels: {
                    'åœ‹å°': { q: "å…‰åœ¨ç©ºæ°£ä¸­æ˜¯æ€éº¼èµ°çš„ï¼Ÿ", opts: ["ç›´ç·š", "åœ“åœˆ", "æ³¢æµª"], a: "ç›´ç·š", t: "å…‰æ˜¯ç›´ç·šå‚³æ’­çš„ï¼Œæ‰€ä»¥æ‰æœ‰å½±å­ã€‚" },
                    'å¤§å­¸': { q: "å…‰é›»æ•ˆæ‡‰èªªæ˜äº†å…‰çš„ä»€éº¼æœ¬è³ªï¼Ÿ", opts: ["æ³¢å‹•æ€§", "ç²’å­æ€§", "ä¸é€£çºŒæ€§"], a: "ç²’å­æ€§", t: "æ„›å› æ–¯å¦æå‡ºå…‰å­å‡èªªï¼Œè­‰æ˜èƒ½é‡æ˜¯é‡å­åŒ–çš„ã€‚" },
                    'ç¢©åš': { q: "åœ¨è²çˆ¾å¯¦é©—ä¸­ï¼Œé•åè²çˆ¾ä¸ç­‰å¼æ„å‘³è‘—ï¼Ÿ", opts: ["å®šåŸŸå¯¦åœ¨è«–å¤±æ•ˆ", "å…‰é€Ÿå¯è¶…è¶Š", "èƒ½é‡ä¸å®ˆæ†"], a: "å®šåŸŸå¯¦åœ¨è«–å¤±æ•ˆ", t: "é€™è­‰æ˜äº†é‡å­ç³¾çºæ˜¯éå®šåŸŸçš„æ·±å±¤é—œè¯ã€‚" }
                }},
                { topic: "æ–‡å­¸èˆ‡å“²å­¸", levels: {
                    'åœ‹å°': { q: "ã€ŒåºŠå‰æ˜æœˆå…‰ã€çš„ä¸‹ä¸€å¥æ˜¯ï¼Ÿ", opts: ["ç–‘æ˜¯åœ°ä¸Šéœœ", "èˆ‰é ­æœ›æ˜æœˆ", "ä½é ­æ€æ•…é„‰"], a: "ç–‘æ˜¯åœ°ä¸Šéœœ", t: "é€™æ˜¯æç™½çš„ã€Šéœå¤œæ€ã€‹ï¼Œå½¢å®¹æœˆå…‰å¾ˆäº®ã€‚" },
                    'å¤§å­¸': { q: "å­˜åœ¨ä¸»ç¾©ä¸­ã€Œå­˜åœ¨å…ˆæ–¼æœ¬è³ªã€æ˜¯èª°æå‡ºçš„ï¼Ÿ", opts: ["è–©ç‰¹", "æµ·å¾·æ ¼", "å°¼é‡‡"], a: "è–©ç‰¹", t: "é€™æ„å‘³è‘—äººæ˜¯é€éè‡ªå·±çš„é¸æ“‡ä¾†å®šç¾©è‡ªå·±ã€‚" },
                    'ç¢©åš': { q: "å¾·å¸Œé”çš„ã€Œå»¶ç•°ã€(DiffÃ©rance) æ ¸å¿ƒåœ¨æ–¼ï¼Ÿ", opts: ["æ„ç¾©çš„ç„¡é™å»¶é²", "èªè¨€çš„ç²¾ç¢ºæ€§", "çµæ§‹çš„ç©©å®š"], a: "æ„ç¾©çš„ç„¡é™å»¶é²", t: "é€™æ˜¯è§£æ§‹ä¸»ç¾©çš„æ ¸å¿ƒï¼Œå¼·èª¿æ„ç¾©åœ¨ç¬¦è™Ÿéˆä¸­æ°¸é ç„¡æ³•å®Œå…¨ç¾èº«ã€‚" }
                }}
            ];
            return pool[Math.floor(Math.random() * pool.length)];
        }
    };

    const CONFIG = { 'åœ‹å°': { t: 180, r: 0.1, p: 2 }, 'åœ‹ä¸­': { t: 60, r: 0.5, p: 5 }, 'é«˜ä¸­': { t: 30, r: 1.0, p: 10 }, 'å¤§å­¸': { t: 0, r: 2.5, p: 25 }, 'ç¢©åš': { t: 0, r: 5.0, p: 45 } };

    function triggerLoad() {
        if(state.mode !== 'idle') return;
        state.topicData = RealQuestionBank.fetch();
        document.getElementById('main-panel').style.display = 'block';
        document.getElementById('panel-title').innerText = `é¸é¡Œï¼š${state.topicData.topic}`;
        document.getElementById('panel-content').innerText = "è«‹å…ˆé¸æ“‡é›£åº¦ç´šåˆ¥ï¼š";
        document.getElementById('difficulty-selector').style.display = 'grid';
        document.getElementById('options-area').innerHTML = "";
        document.getElementById('control-area').innerHTML = "";
    }

    function setDiff(level) {
        state.level = level;
        if(!state.topicData.levels[level]) { alert("è©²é›£åº¦é¡Œç›®æ­£åœ¨é›²ç«¯åŒæ­¥ä¸­ï¼Œè«‹é¸å…¶ä»–é›£åº¦ï¼ˆæ¸¬è©¦ç‰ˆç›®å‰é–‹æ”¾åœ‹å°/å¤§å­¸/ç¢©åšï¼‰"); return; }
        document.getElementById('difficulty-selector').style.display = 'none';
        document.getElementById('panel-content').innerText = `é›£åº¦ [${level}] è¨­å®šæˆåŠŸã€‚è«‹é»æ“Šä¸Šæ–¹å°å¸«é–‹å§‹æˆèª²ã€‚`;
    }

    function selectTeacher(t) {
        if(!state.level || state.mode !== 'idle') return;
        state.mode = 'teaching';
        state.teacher = t;
        document.getElementById(t === 'ling' ? 'pod-yi' : 'pod-ling').classList.add('locked');
        
        const qData = state.topicData.levels[state.level];
        document.getElementById('panel-title').innerText = `å°å¸«ï¼šæ±Ÿ${t==='ling'?'éˆ´':'ä¾'} [${state.level}]`;
        document.getElementById('panel-content').innerText = `ã€å°å¸«æˆèª²ã€‘${qData.t}`;
        document.getElementById('control-area').innerHTML = `<button class="btn" onclick="startExam()">æˆ‘å­¸å¥½äº†ï¼Œé–‹å§‹è€ƒé©—</button>`;
    }

    function startExam() {
        state.mode = 'exam';
        const qData = state.topicData.levels[state.level];
        const conf = CONFIG[state.level];
        document.getElementById('panel-content').innerText = `ã€è€ƒé©—ã€‘${qData.q}`;
        document.getElementById('control-area').innerHTML = "";
        document.getElementById('options-area').innerHTML = qData.opts.map(o => 
            `<button class="btn opt-btn" onclick="submit('${o}')">${o}</button>`
        ).join('');

        if(conf.t > 0) {
            let s = conf.t;
            state.timer = setInterval(() => {
                s--;
                document.getElementById('timer-ui').innerText = `${s}s`;
                if(s <= 0) submit('');
            }, 1000);
        } else { document.getElementById('timer-ui').innerText = "âˆ ç ”è¨"; }
    }

    function submit(ans) {
        clearInterval(state.timer);
        const qData = state.topicData.levels[state.level];
        const conf = CONFIG[state.level];
        if(ans === qData.a) {
            const gain = Math.floor(1000 * conf.r);
            state.coin += gain;
            alert(`æ­£ç¢ºï¼ç²å¾— ${gain} ç›æ˜ç‡ˆã€‚`);
        } else {
            state.hp -= conf.p;
            alert(`éŒ¯èª¤ï¼æ‰£é™¤ ${conf.p} HPã€‚æ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š${qData.a}`);
        }
        reset();
    }

    function reset() {
        state.mode = 'idle'; state.level = '';
        document.getElementById('main-panel').style.display = 'none';
        document.getElementById('pod-ling').classList.remove('locked');
        document.getElementById('pod-yi').classList.remove('locked');
        document.getElementById('timer-ui').innerText = "";
        updateUI();
    }

    function exchange() {
        if(state.coin <= 0) return alert("æ˜ç‡ˆä¸è¶³ï¼");
        state.coin = 0;
        alert("æ¼”åŒ–å•Ÿå‹•ï¼æ˜ç‡ˆé‡ç½®æ­¸é›¶ã€‚");
        updateUI();
    }

    function updateUI() {
        document.getElementById('coin-ui').innerText = state.coin;
        document.getElementById('hp-ui').innerText = state.hp;
    }
</script>
</body>
</html>
