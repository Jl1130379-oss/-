<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>æ±Ÿå®¶æ™ºæ…§åŸå¸‚ | å°ˆæ³¨å­¸è¡“ç³»çµ±</title>
    <style>
        :root { --blue: #00f2fe; --pink: #ff00de; --gold: #ffd700; --bg: #010206; }
        body { margin: 0; background: var(--bg); color: #fff; font-family: 'PingFang TC', sans-serif; overflow-x: hidden; }
        .viewport { width: 100vw; height: 100vh; display: flex; flex-direction: column; position: relative; }
        
        /* é ‚éƒ¨æ•¸æ“šç‹€æ…‹ */
        .hud { display: flex; justify-content: space-between; padding: 20px 40px; background: rgba(0,0,0,0.6); border-bottom: 2px solid var(--blue); }
        .stat-box { font-size: 1.2rem; font-weight: bold; text-shadow: 0 0 10px var(--blue); }

        /* å°å¸«ç”Ÿå‘½è‰™ */
        .stage { display: flex; justify-content: center; align-items: center; gap: 80px; flex: 1; transition: 0.5s; }
        .char-pod { text-align: center; cursor: pointer; transition: 0.5s ease; width: 220px; position: relative; }
        .avatar { 
            width: 200px; height: 200px; border-radius: 50%; border: 4px solid var(--blue);
            background-size: cover; background-position: center; box-shadow: 0 0 30px rgba(0, 242, 254, 0.3); margin-bottom: 10px;
        }
        
        /* ã€è¦å‰‡ã€‘ä¸­é€”ä¸å¯æ›èª²é–å®š */
        .locked { filter: grayscale(1) brightness(0.2) blur(2px); opacity: 0.3; pointer-events: none; transform: scale(0.9); }

        /* æ™ºæ…§äº¤äº’é¢æ¿ */
        .panel {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 900px; background: rgba(5, 12, 30, 0.98);
            border: 2px solid var(--gold); border-radius: 35px; padding: 35px;
            display: none; z-index: 2000; box-shadow: 0 0 60px #000;
        }
        .timer-ui { float: right; font-size: 2.2rem; color: var(--pink); font-family: 'Courier New', monospace; }
        .btn { padding: 12px 30px; border-radius: 50px; border: 1px solid var(--blue); background: transparent; color: #fff; cursor: pointer; font-weight: bold; margin: 8px; transition: 0.3s; }
        .btn:hover { background: var(--blue); color: #000; box-shadow: 0 0 15px var(--blue); }
        .opt-btn { width: 100%; text-align: left; margin: 8px 0; background: rgba(255,255,255,0.05); border-color: rgba(0,242,254,0.3); }

        .diff-selector { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-top: 20px; }
    </style>
</head>
<body>

<div class="viewport">
    <div class="hud">
        <div class="stat-box" style="color:var(--gold)">ğŸ® æ˜ç‡ˆ: <span id="coin-ui">0</span></div>
        <div id="status-tag">ğŸ›ï¸ åŸå¸‚å¤§å»³ - è«‹é»æ“Šè‡ªå‹•åŠ é¡Œ</div>
        <div class="stat-box" style="color:var(--pink)">â¤ï¸ HP: <span id="hp-ui">100</span></div>
    </div>

    <div class="stage">
        <div class="char-pod" id="pod-ling" onclick="handleTeacher('ling')">
            <div class="avatar" style="background-image: url('https://i.postimg.cc/mrhp4G1r/ling.png');"></div>
            <h3 style="color:var(--blue)">æ±Ÿéˆ´ (ç†ç§‘)</h3>
            <div style="font-size:0.8rem; color:var(--gold)">ğŸ‘— æµå‹•æ¥µå…‰è£™</div>
        </div>
        <div class="char-pod" id="pod-yi" onclick="handleTeacher('yi')">
            <div class="avatar" style="background-image: url('https://i.postimg.cc/pT3Y0yB0/yi.png'); border-color:var(--pink)"></div>
            <h3 style="color:var(--pink)">æ±Ÿä¾ (æ–‡ç§‘)</h3>
            <div style="font-size:0.8rem; color:var(--gold)">ğŸ‘˜ è½æ«»ç¹½ç´›æ¼¢æœ</div>
        </div>
    </div>

    <div class="panel" id="main-panel">
        <div id="timer-ui" class="timer-ui"></div>
        <h2 id="panel-title" style="color:var(--gold)"></h2>
        <div id="panel-text" style="font-size: 1.15rem; line-height: 1.8; margin-bottom: 20px;"></div>
        <div id="diff-grid" class="diff-selector"></div>
        <div id="options-area"></div>
        <div id="footer-ctrl" style="text-align:center;"></div>
    </div>

    <div style="text-align:center; padding-bottom: 40px;">
        <button id="add-course-btn" class="btn" style="border-color:var(--gold); color:var(--gold)" onclick="autoLoad()">âš¡ è‡ªå‹•åŠ èª² (ç·šä¸ŠçœŸé¡Œ)</button>
        <button class="btn" onclick="exchange()">å‹•ä½œæ¼”åŒ– (æ‰£5000)</button>
    </div>
</div>

<script>
    let state = { coin: 0, hp: 100, mode: 'idle', level: '', teacher: '', currentTopic: null, timer: null };

    // çœŸå¯¦é¡Œåº«èˆ‡æ·±åº¦æ•¸æ“š
    const DATA_BANK = [
        { topic: "é»‘æ´ç‰©ç†å­¸", levels: {
            'åœ‹å°': { q: "é»‘æ´ä¹‹æ‰€ä»¥è¢«ç¨±ç‚ºé»‘æ´ï¼Œæ˜¯å› ç‚ºé€£ä»€éº¼éƒ½è·‘ä¸å‡ºä¾†ï¼Ÿ", opts: ["å…‰", "è²æ³¢", "å°é³¥"], a: "å…‰", t: "é»‘æ´çš„é‡åŠ›æ¥µå¼·ï¼Œé€£å®‡å®™ä¸­æœ€å¿«çš„å…‰ä¹Ÿæœƒè¢«å¸å…¥ã€‚" },
            'åœ‹ä¸­': { q: "é»‘æ´çš„é‚Šç•Œè¢«ç¨±ç‚ºä»€éº¼ï¼Ÿ", opts: ["äº‹ä»¶è¦–ç•Œ", "åœ°å¹³ç·š", "çµ‚æ­¢ç·š"], a: "äº‹ä»¶è¦–ç•Œ", t: "ä¸€æ—¦è¶Šéäº‹ä»¶è¦–ç•Œï¼Œä»»ä½•è¨Šæ¯éƒ½ç„¡æ³•å‚³å›å¤–éƒ¨å®‡å®™ã€‚" },
            'ç¢©åš': { q: "é—œæ–¼é»‘æ´è³‡è¨Šæ‚–è«–ï¼Œéœé‡‘è¼»å°„æ„å‘³è‘—é»‘æ´æœƒï¼Ÿ", opts: ["è’¸ç™¼ä¸¦ä¸Ÿå¤±è³‡è¨Š", "æ°¸ä¹…æ“´å¼µ", "è®Šæˆæ†æ˜Ÿ"], a: "è’¸ç™¼ä¸¦ä¸Ÿå¤±è³‡è¨Š", t: "é€™å¼•ç™¼äº†é‡å­åŠ›å­¸ä¹ˆæ­£æ€§èˆ‡å»£ç¾©ç›¸å°è«–çš„è¡çªè¨è«–ã€‚" }
        }},
        { topic: "å¤å…¸æ–‡å­¸", levels: {
            'åœ‹å°': { q: "ã€Šéœå¤œæ€ã€‹ä¸­æç™½æŠŠæœˆå…‰æ¯”å–»æˆä»€éº¼ï¼Ÿ", opts: ["éœœ", "é›ª", "ç³–"], a: "éœœ", t: "ã€Œç–‘æ˜¯åœ°ä¸Šéœœã€å½¢å®¹æœˆå…‰æ½”ç™½å‡é‡ã€‚" },
            'å¤§å­¸': { q: "ç‹ç¶­è©©å¥ã€Œè¡Œåˆ°æ°´çª®è™•ï¼Œåçœ‹é›²èµ·æ™‚ã€é«”ç¾äº†å“ªç¨®ä½›å®¶å¢ƒç•Œï¼Ÿ", opts: ["ç©ºéˆç¦ªæ„", "ç—›è‹¦åŸ·è‘—", "ç©æ¥µå…¥ä¸–"], a: "ç©ºéˆç¦ªæ„", t: "é€™åæ˜ äº†éš¨é‡è€Œå®‰ã€ç‰©æˆ‘å…©å¿˜çš„ç‘è„«å¢ƒç•Œã€‚" },
            'ç¢©åš': { q: "ã€Šç´…æ¨“å¤¢ã€‹ä¸­ã€Œè‰è›‡ç°ç·šï¼Œä¼è„ˆåƒé‡Œã€æ˜¯æŒ‡ï¼Ÿ", opts: ["æ•˜äº‹çµæ§‹çš„éš±å–»èˆ‡é‹ªå¢Š", "æå¯«æ‰‹æ³•ç”Ÿå‹•", "èƒŒæ™¯æ•…äº‹å®å¤§"], a: "æ•˜äº‹çµæ§‹çš„éš±å–»èˆ‡é‹ªå¢Š", t: "è„‚æ‰¹ä»¥æ­¤å½¢å®¹æ›¹é›ªèŠ¹æ¥µå…¶åš´å¯†çš„ä¼ç­†ä½ˆå±€èƒ½åŠ›ã€‚" }
        }}
    ];

    const CONFIG = { 'åœ‹å°':{t:180,r:0.1,p:5}, 'åœ‹ä¸­':{t:60,r:0.5,p:10}, 'é«˜ä¸­':{t:30,r:1.0,p:20}, 'å¤§å­¸':{t:0,r:2.5,p:30}, 'ç¢©åš':{t:0,r:5.0,p:50} };

    function autoLoad() {
        if(state.mode !== 'idle') return;
        state.currentTopic = DATA_BANK[Math.floor(Math.random() * DATA_BANK.length)];
        document.getElementById('main-panel').style.display = 'block';
        document.getElementById('panel-title').innerText = `é¸æ“‡é›£åº¦ï¼š${state.currentTopic.topic}`;
        document.getElementById('panel-text').innerText = "è«‹é¸å®šå­¸ç¿’é›£åº¦ (åœ‹å°äº« 3 åˆ†é˜æ€è€ƒï¼Œå¤§å­¸ä»¥ä¸Šä¸é™æ™‚)ï¼š";
        document.getElementById('diff-grid').innerHTML = Object.keys(CONFIG).map(l => 
            `<button class="btn" onclick="setLevel('${l}')">${l}</button>`
        ).join('');
        document.getElementById('options-area').innerHTML = "";
        document.getElementById('footer-ctrl').innerHTML = "";
    }

    function setLevel(l) {
        state.level = l;
        document.getElementById('diff-grid').innerHTML = "";
        document.getElementById('panel-text').innerText = `[${l}] é›£åº¦è¨­å®šå®Œæˆã€‚è«‹é¸å®šä¸€ä½å°å¸«é€²è¡Œæˆèª²ã€‚`;
    }

    function handleTeacher(t) {
        if(!state.level || state.mode !== 'idle') return;
        state.mode = 'teaching';
        state.teacher = t;
        
        // é–å®šè€å¸«
        document.getElementById(t === 'ling' ? 'pod-yi' : 'pod-ling').classList.add('locked');
        
        const qData = state.currentTopic.levels[state.level] || state.currentTopic.levels['åœ‹å°']; // å‚™ä»½
        document.getElementById('panel-title').innerText = `å°å¸«ï¼šæ±Ÿ${t==='ling'?'éˆ´':'ä¾'} [${state.level}]`;
        document.getElementById('panel-text').innerText = `ã€å°ˆæ³¨æˆèª²ã€‘${qData.t}`;
        document.getElementById('footer-ctrl').innerHTML = `<button class="btn" onclick="startExam()">ç ”ç¿’å®Œç•¢ï¼Œé€²å…¥è€ƒé©—</button>`;
    }

    function startExam() {
        state.mode = 'exam';
        const qData = state.currentTopic.levels[state.level] || state.currentTopic.levels['åœ‹å°'];
        const conf = CONFIG[state.level];
        document.getElementById('panel-text').innerText = `ã€è€ƒé©—ã€‘${qData.q}`;
        document.getElementById('footer-ctrl').innerHTML = "";
        document.getElementById('options-area').innerHTML = qData.opts.map(o => 
            `<button class="btn opt-btn" onclick="submit('${o}')">${o}</button>`
        ).join('');

        if(conf.t > 0) {
            let s = conf.t;
            state.timer = setInterval(() => {
                s--;
                document.getElementById('timer-ui').innerText = `${s}s`;
                if(s <= 0) submit('');
            }, 1000);
        } else { document.getElementById('timer-ui').innerText = "âˆ ç ”è¨"; }
    }

    function submit(ans) {
        clearInterval(state.timer);
        const qData = state.currentTopic.levels[state.level] || state.currentTopic.levels['åœ‹å°'];
        const conf = CONFIG[state.level];
        if(ans === qData.a) {
            const gain = Math.floor(1000 * conf.r);
            state.coin += gain;
            alert(`æ­£ç¢ºï¼çå‹µ ${gain} ç›æ˜ç‡ˆã€‚`);
        } else {
            state.hp -= conf.p;
            alert(`éŒ¯èª¤ï¼æ‰£é™¤ ${conf.p} HPã€‚\næ­£è§£ï¼š${qData.a}`);
        }
        reset();
    }

    function reset() {
        state.mode = 'idle'; state.level = '';
        document.getElementById('main-panel').style.display = 'none';
        document.getElementById('pod-ling').classList.remove('locked');
        document.getElementById('pod-yi').classList.remove('locked');
        document.getElementById('timer-ui').innerText = "";
        updateUI();
    }

    function exchange() {
        if(state.coin < 5000) return alert("æ˜ç‡ˆä¸è¶³ 5000ï¼Œç„¡æ³•æ¼”åŒ–å‹•ä½œã€‚");
        state.coin -= 5000;
        alert("æ¼”åŒ–æˆåŠŸï¼æ¶ˆè€— 5000 æ˜ç‡ˆï¼Œå‹•ä½œåº«å·²æ›´æ–°ã€‚");
        updateUI();
    }

    function updateUI() {
        document.getElementById('coin-ui').innerText = state.coin;
        document.getElementById('hp-ui').innerText = state.hp;
    }
</script>
</body>
</html>
