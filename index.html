<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>æ±Ÿå®¶æ™ºæ…§åŸå¸‚ | å…ˆå­¸å¾Œè€ƒæ¨¡å¼</title>
    <style>
        :root { --blue: #00f2fe; --pink: #ff00de; --gold: #ffd700; --panel: rgba(5, 12, 25, 0.98); }
        body { margin: 0; background: #000; color: #fff; overflow: hidden; font-family: "PingFang TC", sans-serif; }
        .viewport { position: fixed; inset: 20px; background: var(--panel); border-radius: 35px; display: flex; flex-direction: column; padding: 20px; border: 1px solid var(--blue); }
        
        /* è€å¸«èˆå° */
        .stage { display: flex; justify-content: space-around; align-items: center; flex: 1; }
        .avatar-container { position: relative; width: 180px; height: 180px; cursor: pointer; }
        .avatar-frame { width: 100%; height: 100%; border-radius: 50%; border: 4px solid var(--blue); background-size: cover; overflow: hidden; }
        
        /* æ•™å­¸èˆ‡ç­”é¡Œå€ */
        .edu-panel { position: relative; background: rgba(255,255,255,0.08); border-radius: 25px; padding: 25px; min-height: 200px; text-align: center; }
        .timer-bar { height: 4px; background: var(--blue); width: 100%; position: absolute; top: 0; left: 0; transition: linear; }
        
        /* é–å®šç‹€æ…‹ */
        .locked { opacity: 0.5; filter: grayscale(1); pointer-events: none; }

        /* å½ˆçª— */
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: none; justify-content: center; align-items: center; z-index: 2000; }
        .chat-box { width: 350px; background: #111; border: 1px solid var(--gold); border-radius: 20px; padding: 20px; }
        .opt-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
        .btn-opt { padding: 12px; background: transparent; border: 1px solid var(--blue); color: #fff; border-radius: 10px; cursor: pointer; }
    </style>
</head>
<body onload="init()">

<div class="viewport">
    <div style="display:flex; justify-content: space-between; padding: 10px;">
        <span id="status-tag" style="color:var(--gold)">ğŸ›ï¸ å¤§å»³æš«æ­‡ä¸­</span>
        <div>
            <span style="margin-right:20px;">ğŸ® æ˜ç‡ˆ: <span id="coin-ui">0</span></span>
            <span>â¤ï¸ HP: <span id="hp-ui">100</span></span>
        </div>
    </div>

    <div class="stage" id="teacher-stage">
        <div class="char-box" onclick="handleAvatarClick('ling')">
            <div id="ling-frame" class="avatar-frame" style="background-image:url('https://api.dicebear.com/7.x/avataaars/svg?seed=JiangLing&accessories=glasses')"></div>
            <h4 style="color:var(--blue); text-align:center">æ±Ÿéˆ´ (ç†ç§‘)</h4>
        </div>
        <div class="char-box" onclick="handleAvatarClick('yi')">
            <div id="yi-frame" class="avatar-frame" style="background-image:url('https://api.dicebear.com/7.x/avataaars/svg?seed=JiangYi'); border-color:var(--pink)"></div>
            <h4 style="color:var(--pink); text-align:center">æ±Ÿä¾ (æ–‡ç§‘)</h4>
        </div>
    </div>

    <div id="edu-ui" class="edu-panel" style="display:none;">
        <div id="t-bar" class="timer-bar"></div>
        <h3 id="edu-title" style="color:var(--gold)">æ•™å­¸æ™‚é–“</h3>
        <p id="edu-content" style="line-height:1.6; font-size:1.1rem;"></p>
        <div id="quiz-options" class="opt-grid" style="display:none;"></div>
        <button id="next-btn" onclick="startExam()" style="display:none; margin-top:15px; padding:10px 30px; border-radius:15px; background:var(--gold); border:none; cursor:pointer;">æˆ‘å­¸å¥½äº†ï¼Œé–‹å§‹è€ƒé©—</button>
    </div>

    <div id="menu-ui" style="text-align:center; padding:15px;">
        <button onclick="openSelector('course')" style="padding:12px 40px; border-radius:20px; background:var(--blue); border:none; font-weight:bold; cursor:pointer;">é¸æ“‡ä»Šæ—¥èª²é¡Œ (ä¸å¯ä¸­é€”æ›èª²)</button>
    </div>
</div>

<div id="pop" class="overlay">
    <div id="pop-content"></div>
</div>

<script>
    let state = { coin: 0, hp: 100, mode: 'idle', currentTeacher: '', currentData: null };

    // æ“´å……é¡Œåº«ï¼šæ•™å­¸ + ç›¸æ‡‰é¡Œç›®
    const courseDB = {
        'ç†ç§‘': {
            teacher: 'æ±Ÿéˆ´',
            teaching: "æ±Ÿéˆ´ï¼šã€è§€å¯Ÿé€™çµ„å°æ•¸å…¬å¼ï¼Œç•¶ Î”x è¶¨è¿‘æ–¼ 0 æ™‚ï¼Œæˆ‘å€‘èƒ½å¾—åˆ°ç¬æ™‚è®ŠåŒ–ç‡ã€‚é€™æ˜¯å¾®ç©åˆ†çš„åŸºçŸ³ï¼Œå‹™å¿…è¨˜ä½å…¬å¼çš„æ¨å°éç¨‹ã€‚ã€",
            question: "æ ¹æ“šå‰›æ‰çš„æ•™å­¸ï¼Œå°æ•¸åœ¨å¹¾ä½•ä¸Šä»£è¡¨ä»€éº¼ï¼Ÿ",
            options: ["åˆ‡ç·šæ–œç‡", "æ›²ç·šé•·åº¦", "åœ“é¢ç©"],
            answer: "åˆ‡ç·šæ–œç‡",
            time: 15
        },
        'æ–‡ç§‘': {
            teacher: 'æ±Ÿä¾',
            teaching: "æ±Ÿä¾ï¼šã€ã€Œè½æ«»ç¹½ç´›ã€èªå‡ºé™¶æ·µæ˜çš„ã€Šæ¡ƒèŠ±æºè¨˜ã€‹ã€‚é€™ä¸åƒ…æ˜¯æ™¯è‰²çš„æå¯«ï¼Œæ›´å¯„è¨—äº†è©©äººå°ç†æƒ³ç¤¾æœƒçš„åš®å¾€ã€‚æ„Ÿå—æ–‡å­—é–“çš„å¯§éœã€‚ã€",
            question: "ã€Šæ¡ƒèŠ±æºè¨˜ã€‹ä¸­æè¿°çš„æ™¯è‰²èˆ‡ä¸‹åˆ—ä½•è€…ç›¸ç¬¦ï¼Ÿ",
            options: ["èŠ³è‰é®®ç¾ï¼Œè½è‹±ç¹½ç´›", "å°æ©‹æµæ°´äººå®¶", "å¤§æ¼ å­¤ç…™ç›´"],
            answer: "èŠ³è‰é®®ç¾ï¼Œè½è‹±ç¹½ç´›",
            time: 30
        }
    };

    function init() { updateUI(); }

    function openSelector(type) {
        const pop = document.getElementById('pop');
        const content = document.getElementById('pop-content');
        pop.style.display = 'flex';
        
        content.innerHTML = `
            <div style="display:flex; gap:20px;">
                <div style="padding:30px; border:1px solid var(--blue); border-radius:20px; cursor:pointer;" onclick="selectCourse('ç†ç§‘')">ã€æ±Ÿéˆ´ã€‘ç†ç§‘ç²¾é¸</div>
                <div style="padding:30px; border:1px solid var(--pink); border-radius:20px; cursor:pointer;" onclick="selectCourse('æ–‡ç§‘')">ã€æ±Ÿä¾ã€‘æ–‡ç§‘ç²¾é¸</div>
            </div>
        `;
    }

    function selectCourse(type) {
        state.mode = 'learning';
        state.currentTeacher = type === 'ç†ç§‘' ? 'ling' : 'yi';
        state.currentData = courseDB[type];
        
        document.getElementById('pop').style.display = 'none';
        document.getElementById('menu-ui').style.display = 'none';
        document.getElementById('edu-ui').style.display = 'block';
        
        // é–å®šå¦ä¸€ä½è€å¸«
        document.getElementById(type === 'ç†ç§‘' ? 'yi-frame' : 'ling-frame').parentElement.classList.add('locked');
        
        // é€²å…¥æ•™å­¸æ¨¡å¼
        document.getElementById('status-tag').innerText = `ğŸ“– æ­£åœ¨æˆèª²ï¼š${type}`;
        document.getElementById('edu-title').innerText = "ğŸ“š è€å¸«æ•™å­¸ä¸­...";
        document.getElementById('edu-content').innerText = state.currentData.teaching;
        document.getElementById('next-btn').style.display = 'inline-block';
    }

    function startExam() {
        state.mode = 'exam';
        document.getElementById('next-btn').style.display = 'none';
        document.getElementById('edu-title').innerText = "ğŸ“ éš¨å ‚è€ƒé©—";
        document.getElementById('edu-content').innerText = state.currentData.question;
        
        const opts = document.getElementById('quiz-options');
        opts.style.display = 'grid';
        opts.innerHTML = state.currentData.options.sort(()=>Math.random()-0.5).map(o => 
            `<button class="btn-opt" onclick="check('${o}')">${o}</button>`
        ).join('');

        // é–‹å§‹è¨ˆæ™‚
        let time = state.currentData.time;
        const bar = document.getElementById('t-bar');
        bar.style.width = "100%";
        bar.style.transition = `width ${time}s linear`;
        setTimeout(() => bar.style.width = "0%", 10);

        state.timer = setTimeout(() => check(''), time * 1000);
    }

    function check(ans) {
        clearTimeout(state.timer);
        if(ans === state.currentData.answer) {
            state.coin += 500; alert("æ±Ÿè€å¸«ï¼šã€å¾ˆå¥½ï¼Œçœ‹ä¾†å¦³æœ‰èªçœŸè½èª²ã€‚ã€");
        } else {
            state.hp -= 10; alert("æ±Ÿè€å¸«ï¼šã€å‰›æ‰ä¸æ˜¯æ‰è¬›éå—ï¼Ÿå°ˆå¿ƒé»ã€‚ã€");
        }
        
        // çµæŸèª²ç¨‹ï¼Œé‡ç½®ç‹€æ…‹
        state.mode = 'idle';
        document.getElementById('edu-ui').style.display = 'none';
        document.getElementById('menu-ui').style.display = 'block';
        document.getElementById('quiz-options').style.display = 'none';
        document.querySelectorAll('.char-box').forEach(e => e.classList.remove('locked'));
        document.getElementById('status-tag').innerText = "ğŸ›ï¸ å¤§å»³æš«æ­‡ä¸­";
        updateUI();
    }

    function handleAvatarClick(teacher) {
        if(state.mode === 'learning' || state.mode === 'exam') {
            alert(`ã€è­¦å‘Šã€‘æ±Ÿ${teacher==='ling'?'éˆ´':'ä¾'}è€å¸«ï¼šã€ä¸Šèª²æœŸé–“ç¦æ­¢ç§èŠï¼Œè«‹å°ˆæ³¨æ–¼çœ¼å‰çš„èª²é¡Œï¼ã€`);
            return;
        }
        
        const pop = document.getElementById('pop');
        pop.style.display = 'flex';
        document.getElementById('pop-content').innerHTML = `
            <div class="chat-box">
                <h3 style="color:var(--gold)">èˆ‡ æ±Ÿ${teacher==='ling'?'éˆ´':'ä¾'} è€å¸«ç§èŠä¸­</h3>
                <p>${teacher==='ling'?'ã€Œå‰›æ‰çš„ç†ç§‘å…¬å¼é‚„æœ‰å“ªè£¡ä¸æ‡‚å—ï¼Ÿã€':'ã€Œç´¯äº†çš„è©±ï¼Œè¦ä¸è¦ä¸€èµ·å–æ¯èŒ¶ï¼Ÿã€'}</p>
                <button onclick="document.getElementById('pop').style.display='none'" style="width:100%; padding:10px; background:var(--blue); border:none; border-radius:10px; cursor:pointer;">çµæŸå°è©±</button>
            </div>
        `;
    }

    function updateUI() {
        document.getElementById('coin-ui').innerText = state.coin;
        document.getElementById('hp-ui').innerText = state.hp;
    }
</script>
</body>
</html>
