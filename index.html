<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±Ÿå®¶æ™ºæ…§åŸå¸‚ï¼šå…¨èƒ½æ•™è‚²å¹³å°</title>
    <style>
        :root { --sci: #22d3ee; --art: #fb7185; --gold: #facc15; --snow: #f0f9ff; --bg: #020617; }
        * { box-sizing: border-box; font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; transition: 0.4s; }
        body { margin: 0; background: var(--bg); color: white; height: 100vh; overflow: hidden; display: flex; flex-direction: column; }
        
        .page { display: none; height: 100vh; flex-direction: column; }
        .active { display: flex; }

        /* ç™»å…¥ä»‹é¢ */
        #page-login { justify-content: center; align-items: center; background: radial-gradient(circle, #1e293b 0%, #020617 100%); }
        .glass-card { background: rgba(255,255,255,0.05); backdrop-filter: blur(15px); padding: 40px; border-radius: 30px; border: 1px solid rgba(255,255,255,0.1); text-align: center; width: 320px; box-shadow: 0 0 30px rgba(34,211,238,0.2); }
        input { width: 100%; padding: 12px; margin: 15px 0; border-radius: 10px; border: none; background: rgba(255,255,255,0.1); color: white; text-align: center; }

        /* é ‚éƒ¨å°èˆª */
        header { padding: 15px 20px; background: rgba(15,23,42,0.95); border-bottom: 2px solid var(--sci); display: flex; justify-content: space-between; align-items: center; z-index: 100; }
        .currency { font-weight: bold; font-size: 1.1rem; }

        /* ä¸»èˆå° */
        main { flex: 1; display: flex; flex-direction: column; align-items: center; padding: 10px; overflow-y: auto; position: relative; }
        .teacher-box { width: 220px; height: 320px; margin-bottom: 10px; position: relative; }
        .teacher-img { width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(0 0 15px rgba(34,211,238,0.3)); }
        .pondering { filter: drop-shadow(0 0 30px var(--gold)) !important; transform: scale(1.05); }

        /* é›£åº¦éšæ¢¯ */
        .ladder { display: flex; gap: 5px; width: 100%; max-width: 450px; margin-bottom: 10px; }
        .ladder-btn { flex: 1; padding: 8px; font-size: 0.7rem; border-radius: 8px; border: 1px solid #334155; background: #1e293b; color: #94a3b8; cursor: pointer; }
        .ladder-active { background: var(--sci); color: #020617; font-weight: bold; border-color: var(--sci); }

        /* ç­”é¡Œå¡ */
        .quiz-card { background: white; color: #1e293b; padding: 25px; border-radius: 30px; width: 100%; max-width: 480px; box-shadow: 0 15px 40px rgba(0,0,0,0.5); }
        .timer-track { height: 6px; background: #e2e8f0; border-radius: 3px; margin: 12px 0; overflow: hidden; }
        #timer-bar { height: 100%; width: 100%; background: var(--sci); }
        .opt-btn { width: 100%; padding: 12px; margin: 6px 0; border: 2px solid #e2e8f0; border-radius: 12px; background: #f8fafc; font-weight: bold; cursor: pointer; text-align: left; }
        .opt-btn:hover { border-color: var(--sci); background: #f0f9ff; }

        /* æ›´è¡£å®¤/å•†å ´ */
        .shop-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; width: 100%; max-width: 480px; }
        .item-card { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 20px; text-align: center; border: 1px solid rgba(255,255,255,0.1); }
        .item-card.equipped { border-color: var(--gold); background: rgba(250, 204, 21, 0.1); }

        /* åº•éƒ¨å°è¦½ */
        nav { height: 75px; background: #0f172a; display: flex; justify-content: space-around; align-items: center; border-top: 1px solid rgba(255,255,255,0.2); }
        .nav-btn { background: none; border: none; color: #94a3b8; cursor: pointer; font-size: 0.8rem; display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .nav-active { color: var(--sci); font-weight: bold; }

        /* é˜²åˆ‡é é®ç½© */
        #cheat-overlay { position: fixed; inset: 0; background: #000; z-index: 9999; display: none; flex-direction: column; align-items: center; justify-content: center; }
        .secret-snow { position: fixed; bottom: 90px; right: 20px; opacity: 0.2; cursor: pointer; font-size: 24px; z-index: 1000; }
    </style>
</head>
<body>

<div id="page-login" class="page active">
    <div class="glass-card">
        <h1 style="color:var(--sci); margin-bottom:5px;">æ™ºæ…§åŸå¸‚</h1>
        <p style="font-size:0.75rem; color:#94a3b8; letter-spacing: 2px;">æ±Ÿå®¶å…¨èƒ½æ•™è‚²ç³»çµ±</p>
        <input type="text" id="user-input" placeholder="å­¸å“¡å§“å / ç·¨è™Ÿ">
        <button class="ladder-btn ladder-active" style="width:100%; padding:15px; font-size: 1rem;" onclick="doLogin()">å•Ÿå‹•å­¸è¡“é€£çµ</button>
    </div>
</div>

<div id="page-main" class="page">
    <header id="main-header">
        <div>
            <div id="admin-banner" style="font-size:0.65rem; color:var(--gold); display:none; font-weight: bold;">ğŸ‘‘ ç®¡ç†å“¡ï¼šæ±Ÿæ†¶å©· (å…¨å ´1æŠ˜)</div>
            <div id="course-title" style="font-weight:900; font-size: 1.1rem;">æ±Ÿéˆ´ï¼šé†«å­¸ç†ç§‘æ•™å®¤</div>
        </div>
        <div style="text-align:right">
            <div class="currency"><span id="coin-type">ğŸª™</span> <span id="coin-val">500</span></div>
            <div id="timer-text" style="font-family:monospace; font-size: 0.8rem; color: var(--sci);">SEC: 180</div>
        </div>
    </header>

    <main>
        <div class="ladder" id="ladder-ui">
            <button id="l-1" class="ladder-btn ladder-active" onclick="setEdu(1)">åœ‹å°</button>
            <button id="l-2" class="ladder-btn" onclick="setEdu(2)">åœ‹é«˜ä¸­</button>
            <button id="l-3" class="ladder-btn" onclick="setEdu(3)">å¤§å­¸</button>
            <button id="l-4" class="ladder-btn" onclick="setEdu(4)">ç¢©åš/ç«¶è³½</button>
        </div>

        <div class="teacher-box">
            <img id="main-img" class="teacher-img" src="IMG_3812.jpeg">
        </div>

        <div id="mod-quiz" class="quiz-card">
            <div style="display:flex; justify-content:space-between; font-size:0.75rem; color:#64748b; font-weight:bold;">
                <span id="q-meta">åœ‹å° - é—œå¡ 1</span>
                <span id="q-reward">çå‹µ: +20</span>
            </div>
            <div class="timer-track"><div id="timer-bar"></div></div>
            <div id="q-text" style="font-weight:bold; min-height:50px; margin:10px 0; line-height: 1.4;">æ­£åœ¨è¼‰å…¥ä»Šæ—¥åŠ èª²é¡Œç›®...</div>
            <div id="q-options"></div>
        </div>

        <div id="mod-shop" style="display:none; width:100%;">
            <h3 style="text-align:center; color:var(--gold); margin-top:0;">æ±Ÿå®¶æ›´è¡£å®¤</h3>
            <div class="shop-grid" id="shop-items"></div>
        </div>
    </main>

    <div class="secret-snow" onclick="tryAdmin()">â„ï¸</div>

    <nav>
        <button class="nav-btn nav-active" id="nav-quiz" onclick="switchMod('quiz')">ğŸ“š èª²ç¨‹ç­”é¡Œ</button>
        <button class="nav-btn" id="nav-shop" onclick="switchMod('shop')">ğŸ‘— æ›´æ›æœé£¾</button>
        <button class="nav-btn" onclick="location.reload()">ğŸšª ç™»å‡ºç³»çµ±</button>
    </nav>
</div>

<div id="cheat-overlay">
    <h1 style="color:#ef4444;">âš ï¸ è­¦å‘Šï¼šåµæ¸¬åˆ°åˆ†é åˆ‡æ›</h1>
    <p style="text-align:center; padding: 0 40px;">ç‚ºäº†ç¶­æŒå­¸è¡“ç´”æ½”æ€§ï¼Œåš´ç¦åœ¨ç­”é¡Œæ™‚æŸ¥é–±å¤–éƒ¨è³‡æ–™ã€‚<br>æœ¬é¡Œå·²é‡ç½®ã€‚</p>
    <button class="ladder-btn ladder-active" style="width:180px; padding:12px; margin-top:20px;" onclick="location.reload()">é‡æ–°é€²å…¥</button>
</div>

<script>
    // --- é…ç½®è³‡æ–™ ---
    const eduLevels = {
        1: { name: "åœ‹å°åŸºç¤", reward: 20, limit: true },
        2: { name: "åœ‹é«˜ä¸­é€²éš", reward: 50, limit: true },
        3: { name: "å¤§å­¸å°ˆæ¥­", reward: 150, limit: true },
        4: { name: "ç¢©åš/ç«¶è³½", reward: 800, limit: false }
    };

    const shopItems = [
        { id: 'sci_basic', name: 'æ¥µå…‰é†«å­¸é•·è£™', price: 2000, img: 'IMG_3812.jpeg', type: 'sci', owned: false },
        { id: 'art_basic', name: 'æ«»è‰²æ¼¢æœæ´‹è£', price: 2000, img: 'IMG_4392.jpg', type: 'art', owned: false },
        { id: 'sci_pro', name: 'ç¢©åšå°å¸«æŠ«è‚©', price: 5000, img: 'SCI_PRO.jpg', type: 'sci', owned: false },
        { id: 'art_pro', name: 'å¢¨æŸ“æ–‡å­¸é•·è¢', price: 5000, img: 'ART_PRO.jpg', type: 'art', owned: false }
    ];

    let state = {
        coins: 500,
        edu: 1,
        stage: 1,
        qIdx: 1,
        timeLeft: 180,
        isAdmin: false,
        currentImg: 'IMG_3812.jpeg'
    };

    // --- æ ¸å¿ƒé‚è¼¯ ---
    function doLogin() {
        const name = document.getElementById('user-input').value;
        if(!name) return alert("è«‹è¼¸å…¥å­¸å“¡å§“åä»¥å»ºç«‹å­¸è¡“é€£çµ");
        document.getElementById('page-login').classList.remove('active');
        document.getElementById('page-main').classList.add('active');
        startEngine();
    }

    function setEdu(lv) {
        state.edu = lv;
        state.stage = 1; state.qIdx = 1;
        state.timeLeft = 180;
        document.querySelectorAll('.ladder-btn').forEach((b,i)=> b.classList.toggle('ladder-active', (i+1)===lv));
        loadQuestion();
    }

    function switchMod(m) {
        document.getElementById('mod-quiz').style.display = m === 'quiz' ? 'block' : 'none';
        document.getElementById('mod-shop').style.display = m === 'shop' ? 'block' : 'none';
        document.getElementById('nav-quiz').classList.toggle('nav-active', m === 'quiz');
        document.getElementById('nav-shop').classList.toggle('nav-active', m === 'shop');
        if(m === 'shop') renderShop();
    }

    function renderShop() {
        const container = document.getElementById('shop-items');
        container.innerHTML = "";
        shopItems.forEach(item => {
            const finalPrice = state.isAdmin ? Math.floor(item.price * 0.1) : item.price;
            const card = document.createElement('div');
            card.className = `item-card ${state.currentImg === item.img ? 'equipped' : ''}`;
            card.innerHTML = `
                <div style="font-size:0.85rem; font-weight:bold; margin-bottom:5px;">${item.name}</div>
                <div style="font-size:0.7rem; color:var(--gold); margin-bottom:10px;">
                    ${item.owned ? 'âœ… å·²æ”¶è—' : `ğŸ’° ${finalPrice} (1æŠ˜ä¸­)`}
                </div>
                <button class="ladder-btn ${item.owned?'ladder-active':''}" style="width:100%" 
                    onclick="${item.owned ? `wear('${item.img}')` : `buy('${item.id}', ${finalPrice})`}">
                    ${item.owned ? (state.currentImg===item.img?'ä½¿ç”¨ä¸­':'æ›è£') : 'è³¼å…¥'}
                </button>
            `;
            container.appendChild(card);
        });
    }

    function buy(id, price) {
        if(state.coins >= price) {
            state.coins -= price;
            shopItems.find(i=>i.id===id).owned = true;
            updateUI(); renderShop();
            alert("ğŸ‘— å·²å°‡ç²¾ç¾æœé£¾æ”¾å…¥æ›´è¡£å®¤ï¼");
        } else alert("ğŸª™ é¤˜é¡ä¸è¶³ï¼Œè«‹åŠªåŠ›ç­”é¡Œè³ºå–ï¼");
    }

    function wear(img) {
        state.currentImg = img;
        document.getElementById('main-img').src = img;
        renderShop();
    }

    // ç®¡ç†å“¡æ ¸å¿ƒ
    function tryAdmin() {
        if(prompt("è«‹è¼¸å…¥ç®¡ç†è€…æˆæ¬Šä»£ç¢¼ï¼š") === "æ±Ÿæ†¶å©·") {
            state.isAdmin = true;
            // é è¨­ç‚ºåœ‹ä¸­ (Level 2)
            setEdu(2);
            // è´ˆé€å…©å¥—æ ¸å¿ƒæœé£¾
            shopItems[0].owned = true;
            shopItems[1].owned = true;
            
            document.getElementById('admin-banner').style.display = 'block';
            document.getElementById('coin-type').innerText = "â„ï¸";
            document.getElementById('main-header').style.borderColor = "var(--gold)";
            document.getElementById('main-header').style.boxShadow = "0 0 15px rgba(250,204,21,0.3)";
            alert("ğŸ‘‘ æ¬Šé™è§£é–ï¼šæ±Ÿæ†¶å©·ç®¡ç†è€…ã€‚\n1. é è¨­é›£åº¦ï¼šåœ‹é«˜ä¸­\n2. è´ˆè¡£ï¼šæ¥µå…‰è£™ & æ«»æ¼¢æœ\n3. å…¨åº—1æŠ˜å„ªæƒ ï¼");
            updateUI();
        }
    }

    function loadQuestion() {
        const lv = eduLevels[state.edu];
        document.getElementById('q-meta').innerText = `${lv.name} - é—œå¡ ${state.stage}`;
        document.getElementById('q-reward').innerText = `çå‹µ: +${lv.reward}`;
        document.getElementById('q-text').innerText = `ã€å°ˆæ¥­èª²é¡Œã€‘åœ¨æ±Ÿå®¶æ™ºæ…§åŸå¸‚çš„æ•™è‚²é«”ç³»ä¸­ï¼Œå°å¸«æœè£çš„é¦–è¦æº–å‰‡ç‚ºä½•ï¼Ÿ`;
        
        const box = document.getElementById('q-options');
        box.innerHTML = "";
        ["ç²¾ç¾ä¸”ä¸éš¨ä¾¿ã€é•·æ¬¾ä¸éœ² (æ­£ç¢ºé¸é …)", "éš¨æ„æ··æ­", "è‰²å½©é®®è±”å³å¯"].sort().forEach(t => {
            const b = document.createElement('button');
            b.className = 'opt-btn';
            b.innerText = t;
            b.onclick = () => {
                if(t.includes("æ­£ç¢º")) {
                    state.coins += lv.reward;
                    if(state.qIdx < 10) state.qIdx++; else { state.stage++; state.qIdx=1; }
                    updateUI(); loadQuestion();
                    alert("âœ¨ ç­”å°äº†ï¼å°å¸«éå¸¸æ»¿æ„å¦³çš„è¡¨ç¾ã€‚");
                } else alert("âŒ æ€è€ƒæœ‰èª¤ï¼Œå†è©¦ä¸€æ¬¡ã€‚");
            };
            box.appendChild(b);
        });
        state.timeLeft = 180;
        document.getElementById('main-img').classList.remove('pondering');
    }

    function startEngine() {
        setInterval(() => {
            const lv = eduLevels[state.edu];
            const bar = document.getElementById('timer-bar');
            const txt = document.getElementById('timer-text');
            
            if(state.timeLeft > 0) {
                state.timeLeft--;
                txt.innerText = `SEC: ${state.timeLeft}`;
                bar.style.width = `${(state.timeLeft/180)*100}%`;
                bar.style.background = state.timeLeft < 30 ? "#ef4444" : "var(--sci)";
            } else if(!lv.limit || state.isAdmin) {
                txt.innerText = "DEPTH PONDERING...";
                txt.style.color = "var(--gold)";
                bar.style.width = "100%"; bar.style.background = "var(--gold)";
                document.getElementById('main-img').classList.add('pondering');
            }
        }, 1000);

        document.addEventListener("visibilitychange", () => {
            if (document.hidden && !state.isAdmin) document.getElementById('cheat-overlay').style.display = 'flex';
        });
        loadQuestion();
    }

    function updateUI() { document.getElementById('coin-val').innerText = state.coins; }
</script>
</body>
</html>
