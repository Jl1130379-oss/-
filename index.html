<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±Ÿå®¶æ™ºæ…§åŸå¸‚ï¼šå­¸è¡“ç¦è¡›çµ‚æ¥µç‰ˆ</title>
    <style>
        :root { --sci: #22d3ee; --art: #fb7185; --gold: #facc15; --bg: #020617; }
        * { box-sizing: border-box; font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; transition: 0.4s; }
        body { margin: 0; background: var(--bg); color: white; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        /* ç‹€æ…‹åˆ— */
        header { padding: 15px 25px; background: rgba(15, 23, 42, 0.95); border-bottom: 2px solid var(--sci); display: flex; justify-content: space-between; align-items: center; z-index: 100; }
        .status-badge { font-size: 0.75rem; font-weight: bold; padding: 4px 12px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.2); }
        .cheat-warning { color: #ef4444; border-color: #ef4444; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0.5; } }

        /* ä¸»èˆå° */
        main { flex: 1; display: flex; flex-direction: column; align-items: center; padding: 20px; position: relative; overflow-y: auto; }
        .teacher-box { width: 220px; height: 300px; position: relative; margin-bottom: 10px; }
        .teacher-img { width: 100%; height: 100%; object-fit: contain; filter: drop-shadow(0 0 20px rgba(34,211,238,0.2)); }
        
        /* ç¢©åšæ¨¡å¼ç‰¹æ•ˆ */
        .pondering { filter: drop-shadow(0 0 30px var(--gold)) !important; transform: scale(1.05); }

        /* é›£åº¦åˆ‡æ› */
        .ladder { display: flex; gap: 8px; margin-bottom: 20px; width: 100%; max-width: 500px; }
        .ladder-btn { flex: 1; padding: 10px; border-radius: 12px; border: 1px solid #334155; background: #1e293b; color: #94a3b8; cursor: pointer; font-size: 0.8rem; }
        .ladder-active { background: var(--sci); color: #020617; border-color: var(--sci); font-weight: bold; }

        /* é¡Œç›®å€åŸŸ */
        .quiz-card { background: white; color: #1e293b; padding: 30px; border-radius: 30px; width: 100%; max-width: 500px; box-shadow: 0 25px 50px rgba(0,0,0,0.6); position: relative; }
        .timer-container { height: 6px; background: #e2e8f0; border-radius: 3px; margin: 15px 0; overflow: hidden; }
        #timer-bar { height: 100%; width: 100%; background: var(--sci); transition: linear; }
        .opt-btn { width: 100%; padding: 14px; margin: 8px 0; border: 2px solid #e2e8f0; border-radius: 15px; background: #f8fafc; font-weight: bold; cursor: pointer; text-align: left; font-size: 1rem; }
        .opt-btn:hover { border-color: var(--sci); background: #f0f9ff; }

        /* é–å®šé€šçŸ¥ */
        #lock-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 1000; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
    </style>
</head>
<body>

<div id="lock-overlay">
    <h1 style="color:#ef4444;">âš ï¸ åµæ¸¬åˆ°é•è¦åˆ‡æ›é é¢</h1>
    <p>å­¸è¡“èª å¯¦æ˜¯æ±Ÿå®¶æ™ºæ…§åŸå¸‚çš„æœ€é«˜åŸå‰‡ã€‚<br>æœ¬é¡Œå·²åˆ¤å®šå¤±æ•—ï¼Œè«‹é»æ“Šä¸‹æ–¹æŒ‰éˆ•é‡å•Ÿæ¸¬é©—ã€‚</p>
    <button class="opt-btn" style="width:200px; text-align:center;" onclick="resetQuiz()">é‡æ–°æŒ‘æˆ°</button>
</div>

<header>
    <div>
        <div id="edu-label" class="status-badge" style="color:var(--gold)">ç¢©åš/ç«¶è³½ï¼šç„¡æ™‚é™æ¨¡å¼</div>
        <div id="teacher-label" style="font-weight: 900; margin-top:5px;">æ±Ÿéˆ´ï¼šé†«å­¸ç†ç§‘ç³»çµ±</div>
    </div>
    <div style="text-align: right;">
        <div style="font-size: 0.9rem; font-weight: bold;">ğŸª™ <span id="coin-val">500</span></div>
        <div id="timer-text" style="font-family: monospace; font-size: 0.8rem;">REMAINING: 180s</div>
    </div>
</header>

<main>
    <div class="ladder">
        <button class="ladder-btn" onclick="setEdu(1)">åœ‹å°</button>
        <button class="ladder-btn" onclick="setEdu(2)">åœ‹é«˜ä¸­</button>
        <button class="ladder-btn" onclick="setEdu(3)">å¤§å­¸</button>
        <button class="ladder-btn ladder-active" onclick="setEdu(4)">ç¢©åš/ç«¶è³½</button>
    </div>

    <div class="teacher-box">
        <img id="t-img" class="teacher-img" src="IMG_3812.jpeg">
    </div>

    <div class="quiz-card">
        <div style="display:flex; justify-content:space-between; font-size:0.75rem; font-weight:bold; color:#64748b;">
            <span id="stage-info">é—œå¡ 1 / 5</span>
            <span id="reward-info">çå‹µ: +800ğŸª™</span>
        </div>
        <div class="timer-container"><div id="timer-bar"></div></div>
        <div id="q-text" style="font-weight:bold; margin: 15px 0; line-height: 1.5;">æ­£åœ¨è¼‰å…¥é«˜éšå­¸è¡“è€ƒé¡Œ...</div>
        <div id="q-options"></div>
    </div>
</main>

<script>
    const eduConfig = {
        1: { name: "åœ‹å°åŸºç¤", time: 180, reward: 20, limit: true },
        2: { name: "åœ‹é«˜ä¸­é€²éš", time: 180, reward: 50, limit: true },
        3: { name: "å¤§å­¸å°ˆæ¥­", time: 180, reward: 150, limit: true },
        4: { name: "ç¢©åš/ç«¶è³½", time: 180, reward: 800, limit: false }
    };

    let state = {
        edu: 4, stage: 1, qIdx: 1, coins: 500,
        timeLeft: 180, teacher: 'sci', isPondering: false
    };

    function init() {
        setEdu(4);
        setInterval(updateTimer, 1000);
        
        // --- æ ¸å¿ƒé˜²å¼Šé‚è¼¯ ---
        document.addEventListener("visibilitychange", () => {
            if (document.hidden) {
                document.getElementById('lock-overlay').style.display = 'flex';
            }
        });
    }

    function setEdu(lv) {
        state.edu = lv;
        state.stage = 1;
        state.qIdx = 1;
        state.timeLeft = 180;
        state.isPondering = false;

        document.querySelectorAll('.ladder-btn').forEach((b, i) => {
            b.classList.toggle('ladder-active', (i + 1) === lv);
        });

        const cfg = eduConfig[lv];
        document.getElementById('edu-label').innerText = `${cfg.name}ï¼š${cfg.limit ? '180s é™æ™‚' : 'ç„¡é™æ™‚æ·±æ€'}`;
        document.getElementById('reward-info').innerText = `çå‹µ: +${cfg.reward}ğŸª™`;
        document.getElementById('t-img').classList.remove('pondering');
        
        loadQuestion();
    }

    function loadQuestion() {
        document.getElementById('stage-info').innerText = `é—œå¡ ${state.stage} / 5 - ç¬¬ ${state.qIdx} é¡Œ`;
        document.getElementById('q-text').innerText = `ã€${eduConfig[state.edu].name}ã€‘é—œæ–¼${state.teacher === 'sci' ? 'é†«å­¸é‚è¼¯' : 'æ–‡å­¸è©•è«–'}çš„é«˜éšç ”ç©¶é¡Œç›®ï¼Ÿ`;
        
        const box = document.getElementById('q-options');
        box.innerHTML = "";
        ["æ­£ç¢ºç ”æ (é ˜å–å ±é…¬)", "éŒ¯èª¤æ¨è«– A", "éŒ¯èª¤æ¨è«– B"].sort(() => Math.random() - 0.5).forEach(t => {
            const btn = document.createElement('button');
            btn.className = 'opt-btn';
            btn.innerText = t;
            btn.onclick = () => handleAnswer(t.includes("æ­£ç¢º"));
            box.appendChild(btn);
        });
        state.timeLeft = 180;
        state.isPondering = false;
        document.getElementById('t-img').classList.remove('pondering');
    }

    function updateTimer() {
        const bar = document.getElementById('timer-bar');
        const txt = document.getElementById('timer-text');
        const cfg = eduConfig[state.edu];

        if (state.timeLeft > 0) {
            state.timeLeft--;
            txt.innerText = `REMAINING: ${state.timeLeft}s`;
            bar.style.width = `${(state.timeLeft / 180) * 100}%`;
            bar.style.background = state.timeLeft < 30 ? "#ef4444" : "var(--sci)";
        } else {
            if (!cfg.limit) {
                // ç¢©åš/ç«¶è³½ï¼šé€²å…¥ç„¡é™æ™‚æ¨¡å¼
                state.isPondering = true;
                txt.innerText = "DEPTH PONDERING...";
                txt.style.color = "var(--gold)";
                bar.style.width = "100%";
                bar.style.background = "var(--gold)";
                document.getElementById('t-img').classList.add('pondering');
            } else {
                txt.innerText = "TIME OUT";
                bar.style.width = "0%";
            }
        }
    }

    function handleAnswer(correct) {
        if (correct) {
            state.coins += eduConfig[state.edu].reward;
            alert("âœ¨ å°å¸«è®šè¨±ï¼šè¦‹è§£ç²¾é—¢ï¼");
            if (state.qIdx < 10) state.qIdx++;
            else { state.stage++; state.qIdx = 1; }
        } else {
            alert("âŒ å°å¸«æé†’ï¼šå­¸è¡“ç ”ç©¶ä¸å®¹ç–æ¼ã€‚");
        }
        document.getElementById('coin-val').innerText = state.coins;
        loadQuestion();
    }

    function resetQuiz() {
        document.getElementById('lock-overlay').style.display = 'none';
        setEdu(state.edu);
    }

    init();
</script>
</body>
</html>
