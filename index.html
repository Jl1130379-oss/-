<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ±Ÿå®¶å§Šå¦¹ï¼šé†«é“èˆ‡æ–‡å¿ƒ</title>
    <style>
        :root { --sci-color: #1B5E20; --art-color: #4A148C; --sci-bg: #E8F5E9; --art-bg: #F3E5F5; }
        body { font-family: "PingFang TC", sans-serif; margin: 0; display: flex; height: 100vh; background: #f0f2f5; transition: background 0.6s ease; overflow: hidden; }
        #sidebar { width: 35%; max-width: 320px; background: #263238; color: white; display: flex; flex-direction: column; }
        .sidebar-header { padding: 30px 15px; background: #1a2327; text-align: center; border-bottom: 2px solid #37474f; }
        .course-list { flex: 1; overflow-y: auto; padding: 15px; }
        .course-card { background: rgba(255,255,255,0.08); border-radius: 18px; padding: 20px; margin-bottom: 15px; cursor: pointer; transition: 0.2s; border: 1px solid transparent; }
        .course-card:active { transform: scale(0.96); background: rgba(255,255,255,0.15); }
        .tag { font-size: 0.8rem; padding: 4px 12px; border-radius: 20px; color: white; font-weight: 600; display: inline-block; margin-bottom: 8px; }
        #main { flex: 1; display: flex; justify-content: center; align-items: center; padding: 25px; overflow-y: auto; }
        .container { width: 100%; max-width: 750px; background: white; border-radius: 45px; padding: 40px; box-shadow: 0 20px 50px rgba(0,0,0,0.08); }
        .teacher-box { display: flex; align-items: center; gap: 20px; margin-bottom: 30px; }
        .avatar { width: 130px; height: 130px; border-radius: 50%; object-fit: cover; border: 5px solid white; box-shadow: 0 8px 20px rgba(0,0,0,0.1); }
        .speech { flex: 1; background: #fcfcfc; padding: 25px; border-radius: 25px; font-size: 1.15rem; line-height: 1.6; border: 1px solid #f0f0f0; }
        h2 { color: #2c3e50; font-size: 1.6rem; margin: 0 0 25px 0; }
        .opt-btn { width: 100%; padding: 22px; margin: 12px 0; border: 2px solid #eee; border-radius: 22px; background: white; cursor: pointer; font-size: 1.25rem; text-align: left; transition: 0.3s; }
        .hidden { display: none; }
        #loading-overlay { position: fixed; inset: 0; background: white; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 100; font-size: 1.2rem; }
    </style>
</head>
<body>
    <div id="loading-overlay"><b>ğŸ“¡ æ­£åœ¨åŒæ­¥æ±Ÿå®¶å§Šå¦¹èª²ç¨‹...</b></div>
    <nav id="sidebar">
        <div class="sidebar-header"><h2 style="margin:0; color: #81d4fa;">é†«é“èˆ‡æ–‡å¿ƒ</h2></div>
        <div id="course-list" class="course-list"></div>
    </nav>
    <main id="main">
        <div class="container">
            <div id="welcome" style="text-align: center;"><h1>æ±Ÿå®¶å§Šå¦¹é›²ç«¯æ•™å®¤</h1><p>è«‹é»é¸å·¦å´èª²ç¨‹</p></div>
            <div id="lesson-ui" class="hidden">
                <div class="teacher-box">
                    <img id="t-avatar" class="avatar" src="">
                    <div class="speech"><strong id="t-name"></strong><br><span id="t-words"></span></div>
                </div>
                <h2 id="q-text"></h2>
                <div id="q-options"></div>
            </div>
        </div>
    </main>
<script>
    // å·²è‡ªå‹•é€£æ¥æ‚¨ IMG_7135 çš„è©¦ç®—è¡¨è³‡æ–™
    const GOOGLE_SHEET_CSV = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTUgIoeIVP3h4C7hoHlAN7gtg_r0AYPMlX5CewmhSMCmE5faKjYD_a--Jo8u3uRmRlS2x6TzgTkvfj4/pub?output=csv";

    const config = {
        sci: { name: "æ±Ÿéˆ´ é†«ç”Ÿ", img: "https://i.imgur.com/G5K5C7i.jpeg", theme: "var(--sci-color)", bg: "var(--sci-bg)", rate: 0.85, intro: "ä½ å¥½ï¼Œæˆ‘æ˜¯æ±Ÿéˆ´ã€‚é€™é¡Œæ¶‰åŠé†«å­¸é‚è¼¯ã€‚" },
        art: { name: "æ±Ÿä¾ åšå£«", img: "https://i.imgur.com/XqT7X9p.jpeg", theme: "var(--art-color)", bg: "var(--art-bg)", rate: 1.15, intro: "å—¨ï¼æˆ‘æ˜¯æ±Ÿä¾ã€‚é€™é¡Œå¾ˆæœ‰è¶£å–”ï¼" }
    };

    async function loadSheets() {
        try {
            const res = await fetch(GOOGLE_SHEET_CSV + '&cache=' + Date.now());
            const csv = await res.text();
            const rows = csv.split("\n").filter(r => r.trim() !== "").map(r => r.split(","));
            const headers = rows[0].map(h => h.trim());
            const data = rows.slice(1).map(row => {
                let obj = {};
                headers.forEach((h, i) => obj[h] = row[i]?.trim());
                return obj;
            });
            renderMenu(data);
            document.getElementById('loading-overlay').classList.add('hidden');
        } catch (e) {
            document.getElementById('loading-overlay').innerHTML = "<b>âŒ é€£ç·šå¤±æ•—</b>";
        }
    }

    function renderMenu(courses) {
        const list = document.getElementById('course-list');
        list.innerHTML = '';
        courses.forEach(c => {
            if(!c.title) return;
            const card = document.createElement('div');
            card.className = 'course-card';
            const teacher = config[c.teacher] || config.sci;
            card.innerHTML = `<span class="tag" style="background:${teacher.theme}">${c.teacher === 'sci' ? 'é†«å­¸' : 'åœ‹å­¸'}</span><strong style="display:block;">${c.title}</strong>`;
            card.onclick = () => startLesson(c);
            list.appendChild(card);
        });
    }

    function startLesson(data) {
        document.getElementById('welcome').classList.add('hidden');
        document.getElementById('lesson-ui').classList.remove('hidden');
        const teacher = config[data.teacher];
        document.body.style.backgroundColor = teacher.bg;
        document.getElementById('t-avatar').src = teacher.img;
        document.getElementById('t-name').innerText = teacher.name;
        document.getElementById('t-words').innerText = teacher.intro;
        document.getElementById('q-text').innerText = data.q;
        const optBox = document.getElementById('q-options');
        optBox.innerHTML = '';
        [data.a1, data.a2].forEach((txt, i) => {
            if(!txt) return;
            const btn = document.createElement('button');
            btn.className = 'opt-btn';
            btn.innerText = txt;
            btn.onclick = () => {
                const isCorrect = (i == data.c);
                const feedback = isCorrect ? "ç­”å°äº†ï¼" : "å†æƒ³æƒ³çœ‹ï¼Ÿ";
                document.getElementById('t-words').innerText = feedback;
                speak(feedback, teacher.rate);
            };
            optBox.appendChild(btn);
        });
        speak(teacher.intro + "é¡Œç›®æ˜¯" + data.q, teacher.rate);
    }

    function speak(text, rate) {
        window.speechSynthesis.cancel();
        const uttr = new SpeechSynthesisUtterance(text);
        uttr.lang = 'zh-TW';
        uttr.rate = rate;
        window.speechSynthesis.speak(uttr);
    }
    loadSheets();
</script>
</body>
</html>
