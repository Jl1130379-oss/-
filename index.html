<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>æ±Ÿå®¶æ™ºæ…§åŸå¸‚ | å®Œæ•´å­¸è¡“é€²éšç‰ˆ</title>
    <style>
        :root { --blue: #00f2fe; --pink: #ff00de; --gold: #ffd700; --bg: #01040a; }
        body { margin: 0; background: var(--bg); color: #fff; font-family: 'PingFang TC', sans-serif; overflow: hidden; }
        .viewport { width: 100vw; height: 100vh; display: flex; flex-direction: column; position: relative; }
        
        /* HUD é ‚éƒ¨æ•¸æ“š */
        .hud { display: flex; justify-content: space-between; padding: 20px 40px; background: rgba(255,255,255,0.03); border-bottom: 2px solid var(--blue); }
        .stat { font-size: 1.2rem; font-weight: bold; text-shadow: 0 0 10px var(--blue); }

        /* å°å¸«èˆå° */
        .stage { display: flex; justify-content: center; align-items: center; gap: 100px; flex: 1; }
        .char-pod { text-align: center; cursor: pointer; transition: 0.5s ease; width: 230px; }
        .avatar { 
            width: 210px; height: 210px; border-radius: 50%; border: 4px solid var(--blue);
            background-size: cover; background-position: center; box-shadow: 0 0 30px rgba(0, 242, 254, 0.2); margin-bottom: 15px;
        }
        .locked { filter: grayscale(1) brightness(0.2); opacity: 0.3; pointer-events: none; transform: scale(0.9); }

        /* æ™ºæ…§æ•™å­¸é¢æ¿ */
        .panel {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 950px; background: rgba(5, 12, 25, 0.98);
            border: 2px solid var(--gold); border-radius: 40px; padding: 35px;
            display: none; z-index: 2000; box-shadow: 0 0 60px #000;
        }
        .timer { float: right; font-size: 2.2rem; color: var(--pink); font-family: monospace; }
        .btn { padding: 14px 35px; border-radius: 50px; border: 1px solid var(--blue); background: transparent; color: #fff; cursor: pointer; font-weight: bold; margin: 8px; transition: 0.3s; }
        .btn:hover { background: var(--blue); color: #000; }
        .opt-btn { width: 100%; text-align: left; background: rgba(255,255,255,0.05); }
        
        .diff-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-top: 20px; }
    </style>
</head>
<body>

<div class="viewport">
    <div class="hud">
        <div class="stat" style="color:var(--gold)">ğŸ® æ˜ç‡ˆ: <span id="coin-ui">0</span></div>
        <div id="status-tag">ğŸ›ï¸ å¤§å»³æš«æ­‡ - è«‹é¸æ“‡è‡ªå‹•åŠ é¡Œ</div>
        <div class="stat" style="color:var(--pink)">â¤ï¸ HP: <span id="hp-ui">100</span></div>
    </div>

    <div class="stage">
        <div class="char-pod" id="pod-ling" onclick="selectTeacher('ling')">
            <div class="avatar" style="background-image: url('https://i.postimg.cc/mrhp4G1r/ling.png');"></div>
            <h3 style="color:var(--blue)">æ±Ÿéˆ´ (ç†ç§‘å°å¸«)</h3>
            <div style="font-size:0.8rem; color:var(--gold)">ğŸ‘— æµå‹•æ¥µå…‰è£™</div>
        </div>
        <div class="char-pod" id="pod-yi" onclick="selectTeacher('yi')">
            <div class="avatar" style="background-image: url('https://i.postimg.cc/pT3Y0yB0/yi.png'); border-color:var(--pink)"></div>
            <h3 style="color:var(--pink)">æ±Ÿä¾ (æ–‡ç§‘å°å¸«)</h3>
            <div style="font-size:0.8rem; color:var(--gold)">ğŸ‘˜ è½æ«»ç¹½ç´›æ¼¢æœ</div>
        </div>
    </div>

    <div class="panel" id="panel">
        <div id="timer-ui" class="timer"></div>
        <h2 id="title-ui" style="color:var(--gold)"></h2>
        <div id="content-ui" style="line-height:1.8; margin-bottom: 20px; font-size: 1.15rem;"></div>
        <div id="diff-selector" class="diff-grid"></div>
        <div id="options-area"></div>
        <div id="control-area" style="text-align:center;"></div>
    </div>

    <div style="text-align:center; padding-bottom: 40px;">
        <button id="add-btn" class="btn" style="border-color:var(--gold); color:var(--gold)" onclick="triggerLoad()">âš¡ è‡ªå‹•åŠ é¡Œ (ç·šä¸ŠæŠ“å–)</button>
        <button class="btn" onclick="exchange()">æ¼”åŒ–æ–°å‹•ä½œ (æ‰£5000)</button>
    </div>
</div>

<script>
    let state = { coin: 0, hp: 100, mode: 'idle', level: '', teacher: '', topic: null, timer: null };

    // ã€äº”é›£åº¦å…¨é¡Œåº«ã€‘
    const MasterBank = [
        { topic: "å®‡å®™å­¸", levels: {
            'åœ‹å°': { q: "å¤ªé™½ç³»ä¸­å“ªé¡†è¡Œæ˜Ÿæœ‰ç¾éº—çš„åœŸæ˜Ÿç’°ï¼Ÿ", opts: ["åœŸæ˜Ÿ", "æœ¨æ˜Ÿ", "ç«æ˜Ÿ"], a: "åœŸæ˜Ÿ", t: "åœŸæ˜Ÿç’°æ˜¯ç”±ç„¡æ•¸å†°å¡Šå’Œç¢çŸ³çµ„æˆçš„ã€‚" },
            'åœ‹ä¸­': { q: "ç¬¬ä¸€ä½è§€æ¸¬åˆ°æ˜Ÿç³»ç´…ç§»ç¾è±¡ï¼Œè­‰æ˜å®‡å®™æ­£åœ¨è†¨è„¹çš„äººæ˜¯ï¼Ÿ", opts: ["å“ˆä¼¯", "ç‰›é “", "ä¼½åˆ©ç•¥"], a: "å“ˆä¼¯", t: "å“ˆä¼¯å®šå¾‹æ˜¯ç¾ä»£å®‡å®™å­¸çš„é‡è¦åŸºçŸ³ã€‚" },
            'é«˜ä¸­': { q: "ç•¶æ†æ˜Ÿæ ¸å¿ƒç‡ƒæ–™è€—ç›¡ï¼Œè³ªé‡ç´„ç‚ºå¤ªé™½ 1.4 å€æ™‚æœƒå¡Œç¸®æˆï¼Ÿ", opts: ["ä¸­å­æ˜Ÿ", "ç™½çŸ®æ˜Ÿ", "é»‘æ´"], a: "ç™½çŸ®æ˜Ÿ", t: "é€™è¢«ç¨±ç‚ºéŒ¢å¾·æ‹‰å¡å¡æ¥µé™ã€‚" },
            'å¤§å­¸': { q: "å»£ç¾©ç›¸å°è«–ä¸­ï¼Œé‡åŠ›è¢«è§£é‡‹ç‚ºï¼Ÿ", opts: ["æ™‚ç©ºæ›²ç‡", "ç¥ç§˜æ‹‰åŠ›", "é›»ç£å¸å¼•"], a: "æ™‚ç©ºæ›²ç‡", t: "ç‰©è³ªå‘Šè¨´æ™‚ç©ºå¦‚ä½•å½æ›²ï¼Œæ™‚ç©ºå‘Šè¨´ç‰©è³ªå¦‚ä½•é‹å‹•ã€‚" },
            'ç¢©åš': { q: "é—œæ–¼æš´è„¹å®‡å®™æ¨¡å‹ï¼Œå…¶ä¸»è¦è§£æ±ºäº†ä»€éº¼å•é¡Œï¼Ÿ", opts: ["è¦–ç•Œå•é¡Œèˆ‡å¹³å¦æ€§å•é¡Œ", "èƒ½é‡å®ˆæ†å•é¡Œ", "ç†µå¢å®šå¾‹æ‚–è«–"], a: "è¦–ç•Œå•é¡Œèˆ‡å¹³å¦æ€§å•é¡Œ", t: "æš´è„¹ç†è«–è§£é‡‹äº†å®‡å®™å¾®æ³¢èƒŒæ™¯è¼»å°„çš„é«˜åº¦å‡å‹»æ€§ã€‚" }
        }},
        { topic: "ç”Ÿå‘½ç§‘å­¸", levels: {
            'åœ‹å°': { q: "èœœèœ‚æ¡èœœå¾Œï¼Œæœƒç”¨ä»€éº¼æ–¹å¼å‘Šè¨´åŒä¼´èŠ±èœœçš„ä½ç½®ï¼Ÿ", opts: ["è·³èˆ", "å¤§å«", "ç•«åœ–"], a: "è·³èˆ", t: "èœœèœ‚é€éã€Œæ–æ“ºèˆã€ä¾†å‚³éæ–¹ä½è³‡è¨Šã€‚" },
            'åœ‹ä¸­': { q: "è¢«ç¨±ç‚ºã€Œç”Ÿå‘½å·¥å» ã€çš„ç´°èƒæ§‹é€ æ˜¯ï¼Ÿ", opts: ["ç·šç²’é«”", "ç´°èƒæ ¸", "ç´°èƒè†œ"], a: "ç·šç²’é«”", t: "ç·šç²’é«”æ˜¯ç´°èƒé€²è¡Œå‘¼å¸ä½œç”¨ç”¢ç”Ÿèƒ½é‡çš„åœ°æ–¹ã€‚" },
            'é«˜ä¸­': { q: "DNA åˆ†å­çµæ§‹ä¸­ï¼Œèˆ‡è…ºå˜Œå‘¤ (A) é…å°çš„æ˜¯ï¼Ÿ", opts: ["èƒ¸è…ºå˜§å•¶ (T)", "èƒå˜§å•¶ (C)", "é³¥å˜Œå‘¤ (G)"], a: "èƒ¸è…ºå˜§å•¶ (T)", t: "é¹¼åŸºäº’è£œé…å°åŸå‰‡æ˜¯éºå‚³å¯†ç¢¼ç©©å®šçš„é—œéµã€‚" },
            'å¤§å­¸': { q: "åœ¨ CRISPR æŠ€è¡“ä¸­ï¼Œå¼•å° Cas9 è›‹ç™½è³ªå°‹æ‰¾ç›®æ¨™åºåˆ—çš„æ˜¯ï¼Ÿ", opts: ["sgRNA", "DNA èšåˆé…¶", "é™åˆ¶é…¶"], a: "sgRNA", t: "å–®éˆå¼•å° RNA è² è²¬ç²¾ç¢ºå®šä½ç›®æ¨™åŸºå› ç‰‡æ®µã€‚" },
            'ç¢©åš': { q: "é—œæ–¼è¡¨è§€éºå‚³å­¸ä¸­çš„ DNA ç”²åŸºåŒ–ï¼Œé€šå¸¸ç™¼ç”Ÿåœ¨ï¼Ÿ", opts: ["CpG å³¶", "ç«¯ç²’", "å…§å«å­"], a: "CpG å³¶", t: "èƒå˜§å•¶ç”²åŸºåŒ–æœƒæŠ‘åˆ¶åŸºå› çš„è½‰éŒ„æ´»æ€§ã€‚" }
        }}
    ];

    const CONFIG = { 'åœ‹å°':{t:180,r:0.1,p:5}, 'åœ‹ä¸­':{t:60,r:0.5,p:10}, 'é«˜ä¸­':{t:30,r:1.0,p:15}, 'å¤§å­¸':{t:0,r:2.5,p:25}, 'ç¢©åš':{t:0,r:5.0,p:45} };

    function triggerLoad() {
        if(state.mode !== 'idle') return;
        state.topic = MasterBank[Math.floor(Math.random() * MasterBank.length)];
        document.getElementById('panel').style.display = 'block';
        document.getElementById('title-ui').innerText = `é¸æ“‡é›£åº¦ï¼š${state.topic.topic}`;
        document.getElementById('content-ui').innerText = "è«‹é¸å®šå­¸ç¿’é›£åº¦ï¼Œè¶Šé«˜é›£åº¦æ˜ç‡ˆçå‹µè¶Šè±å¯Œï¼š";
        document.getElementById('diff-selector').innerHTML = Object.keys(CONFIG).map(l => 
            `<button class="btn" onclick="setDiff('${l}')">${l}</button>`
        ).join('');
        document.getElementById('options-area').innerHTML = "";
        document.getElementById('control-area').innerHTML = "";
    }

    function setDiff(l) {
        state.level = l;
        document.getElementById('diff-selector').innerHTML = "";
        document.getElementById('content-ui').innerText = `å·²è¨­å®šç‚º [${l}]ã€‚è«‹é»æ“Šä¸Šæ–¹å°å¸«é–‹å§‹æˆèª²ã€‚`;
    }

    function selectTeacher(t) {
        if(!state.level || state.mode !== 'idle') return;
        state.mode = 'teaching';
        state.teacher = t;
        document.getElementById(t === 'ling' ? 'pod-yi' : 'pod-ling').classList.add('locked');
        
        const qData = state.topic.levels[state.level];
        document.getElementById('title-ui').innerText = `å°å¸«ï¼šæ±Ÿ${t==='ling'?'éˆ´':'ä¾'} [${state.level}]`;
        document.getElementById('content-ui').innerText = `ã€æˆèª²ã€‘${qData.t}`;
        document.getElementById('control-area').innerHTML = `<button class="btn" onclick="startExam()">ç ”ç¿’å®Œç•¢ï¼Œé€²å…¥è€ƒé©—</button>`;
    }

    function startExam() {
        state.mode = 'exam';
        const qData = state.topic.levels[state.level];
        const conf = CONFIG[state.level];
        document.getElementById('content-ui').innerText = `ã€è€ƒé©—ã€‘${qData.q}`;
        document.getElementById('control-area').innerHTML = "";
        document.getElementById('options-area').innerHTML = qData.opts.map(o => 
            `<button class="btn opt-btn" onclick="submit('${o}')">${o}</button>`
        ).join('');

        if(conf.t > 0) {
            let s = conf.t;
            state.timer = setInterval(() => {
                s--;
                document.getElementById('timer-ui').innerText = `${s}s`;
                if(s <= 0) submit('');
            }, 1000);
        } else { document.getElementById('timer-ui').innerText = "âˆ ç ”è¨"; }
    }

    function submit(ans) {
        clearInterval(state.timer);
        const qData = state.topic.levels[state.level];
        const conf = CONFIG[state.level];
        if(ans === qData.a) {
            const gain = Math.floor(1000 * conf.r);
            state.coin += gain;
            alert(`æ­£ç¢ºï¼çå‹µ ${gain} ç›æ˜ç‡ˆã€‚`);
        } else {
            state.hp -= conf.p;
            alert(`éŒ¯èª¤ï¼æ‰£é™¤ ${conf.p} HPã€‚\nç­”æ¡ˆï¼š${qData.a}`);
        }
        reset();
    }

    function reset() {
        state.mode = 'idle'; state.level = '';
        document.getElementById('panel').style.display = 'none';
        document.getElementById('pod-ling').classList.remove('locked');
        document.getElementById('pod-yi').classList.remove('locked');
        document.getElementById('timer-ui').innerText = "";
        updateUI();
    }

    function exchange() {
        if(state.coin < 5000) return alert("æ˜ç‡ˆä¸è¶³ 5000ï¼");
        state.coin -= 5000;
        alert("æ¼”åŒ–æˆåŠŸï¼æ¶ˆè€— 5000 æ˜ç‡ˆï¼Œé¤˜é¡ä¿ç•™ã€‚");
        updateUI();
    }

    function updateUI() {
        document.getElementById('coin-ui').innerText = state.coin;
        document.getElementById('hp-ui').innerText = state.hp;
    }
</script>
</body>
</html>
